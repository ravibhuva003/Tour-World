{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/RAVI BHUVA/Desktop/Tour-World/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/RAVI BHUVA/Desktop/Tour-World/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/RAVI BHUVA/Desktop/Tour-World/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/RAVI BHUVA/Desktop/Tour-World/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/RAVI BHUVA/Desktop/Tour-World/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useContext}from\"react\";import\"./booking.css\";import{Form,FormGroup,ListGroup,ListGroupItem,Button}from\"reactstrap\";import{useNavigate}from\"react-router-dom\";import{AuthContext}from\"../../context/AuthContext\";import{BASE_URL}from\"../../utils/config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Booking=function Booking(_ref){var tour=_ref.tour,avgRating=_ref.avgRating;var price=tour.price,reviews=tour.reviews,title=tour.title;var navigate=useNavigate();var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState({userId:user&&user._id,//letter it will be dynamic \nuserEmail:user&&user.email,tourName:title,fullName:\" \",phone:\" \",guestSize:1,bookAt:\"\"}),_useState2=_slicedToArray(_useState,2),booking=_useState2[0],setBooking=_useState2[1];var handleChange=function handleChange(e){setBooking(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},e.target.id,e.target.value));});};var serviceFee=10;var totalAmount=Number(price)*Number(booking.guestSize)+Number(serviceFee);//send data to the server\nvar handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var res,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();console.log(booking);_context.prev=2;if(!(!user||user===undefined||user===null)){_context.next=5;break;}return _context.abrupt(\"return\",alert(\"Please Sign in\"));case 5:_context.next=7;return fetch(\"\".concat(BASE_URL,\"/booking\"),{method:'POST',headers:{'content-type':'application/json'},credentials:'include',body:JSON.stringify(booking)});case 7:res=_context.sent;_context.next=10;return res.json();case 10:result=_context.sent;if(!result.ok){navigate(\"/thank-you\");}_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);alert(_context.t0.message);case 17:case\"end\":return _context.stop();}},_callee,null,[[2,14]]);}));return function handleClick(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"booking\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"booking__top d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"span\",{children:\"/per pesrson\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tour__rating d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-s-fill\"}),avgRating===0?null:avgRating,\" (\",reviews===null||reviews===void 0?void 0:reviews.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__form\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Information\"}),/*#__PURE__*/_jsxs(Form,{className:\"booking__info-form\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Full Name\",id:\"fullName\",required:true,onChange:handleChange})}),/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Phone\",id:\"phone\",required:true,onChange:handleChange})}),/*#__PURE__*/_jsxs(FormGroup,{className:\"d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\",id:\"bookAt\",required:true,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Guest\",id:\"guestSize\",required:true,onChange:handleChange})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__bottom\",children:[/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"d-flex align-items-center gap-1\",children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-close-line\"}),\" 1 pesrson\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",price]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Service Charge\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",serviceFee]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0 total\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",totalAmount]})]})]}),/*#__PURE__*/_jsx(Button,{className:\"btn primary__btn w-100 mt-4\",onClick:handleClick,children:\"Book Now\"})]})]});};export default Booking;","map":{"version":3,"names":["React","useState","useContext","Form","FormGroup","ListGroup","ListGroupItem","Button","useNavigate","AuthContext","BASE_URL","Booking","tour","avgRating","price","reviews","title","navigate","user","userId","_id","userEmail","email","tourName","fullName","phone","guestSize","bookAt","booking","setBooking","handleChange","e","prev","target","id","value","serviceFee","totalAmount","Number","handleClick","preventDefault","console","log","undefined","alert","fetch","method","headers","credentials","body","JSON","stringify","res","json","result","ok","message","length"],"sources":["C:/Users/RAVI BHUVA/Desktop/Tour-World/frontend/src/components/Booking/Booking.jsx"],"sourcesContent":["import React,{useState,useContext} from \"react\";\r\nimport \"./booking.css\";\r\nimport {Form,FormGroup,ListGroup,ListGroupItem,Button} from \"reactstrap\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport { BASE_URL } from \"../../utils/config\";\r\n\r\nconst Booking = ({tour,avgRating}) => {\r\n\r\n    const {price,reviews,title}=tour;\r\n    const navigate = useNavigate();\r\n\r\n    const {user} = useContext(AuthContext);\r\n    const [booking,setBooking] = useState({\r\n        userId: user && user._id,  //letter it will be dynamic \r\n        userEmail : user && user.email,\r\n        tourName:title,\r\n        fullName: \" \",\r\n        phone: \" \",\r\n        guestSize: 1,\r\n        bookAt: \"\"\r\n    });\r\n\r\n    const handleChange = e =>{\r\n        setBooking(prev=>({...prev, [e.target.id]:e.target.value}))\r\n    };\r\n\r\n    const serviceFee = 10;\r\n    const totalAmount = Number(price)*Number(booking.guestSize)+Number(serviceFee);\r\n\r\n    //send data to the server\r\n    const handleClick = async e =>\r\n    {\r\n        e.preventDefault();\r\n        console.log(booking);\r\n        try {\r\n            if(!user || user === undefined || user === null){\r\n               return alert(\"Please Sign in\");\r\n              }\r\n              const res = await fetch(`${BASE_URL}/booking`,{\r\n                method: 'POST',\r\n                headers:{\r\n                  'content-type':  'application/json',\r\n                },\r\n                credentials:'include',\r\n                body: JSON.stringify(booking)\r\n              });\r\n              const result = await res.json();\r\n              if(!result.ok){\r\n                navigate(\"/thank-you\");\r\n              }\r\n              \r\n        \r\n        } catch (err) {\r\n            alert(err.message);\r\n        }\r\n        \r\n    }\r\n  return (\r\n    <div className=\"booking\">\r\n        <div className=\"booking__top d-flex align-items-center justify-content-between\">\r\n            <h3>${price} <span>/per pesrson</span></h3>\r\n            <span className=\"tour__rating d-flex align-items-center\">\r\n                <i class=\"ri-star-s-fill\"></i> \r\n                {avgRating === 0 ? null : avgRating } ({reviews?.length})\r\n                </span>\r\n        </div>\r\n        {/* ============booking form =============== */}\r\n\r\n        <div className=\"booking__form\">\r\n            <h5>Information</h5>\r\n            <Form className=\"booking__info-form\" onSubmit={handleClick}>\r\n                <FormGroup>\r\n                    <input type=\"text\" placeholder=\"Full Name\" id=\"fullName\" required onChange={handleChange} />\r\n                </FormGroup>\r\n\r\n                <FormGroup>\r\n                    <input type=\"number\" placeholder=\"Phone\" id=\"phone\" required onChange={handleChange} />\r\n                </FormGroup>\r\n\r\n                <FormGroup className=\"d-flex align-items-center gap-3\">\r\n                    <input type=\"date\" placeholder=\"\" id=\"bookAt\" required onChange={handleChange} />\r\n                    <input type=\"number\" placeholder=\"Guest\" id=\"guestSize\" required onChange={handleChange} />\r\n                </FormGroup>\r\n            </Form>\r\n        </div>\r\n        {/* ============booking end =============== */}\r\n\r\n        {/* ============booking bottom ============ */}\r\n        <div className=\"booking__bottom\">\r\n            <ListGroup>\r\n                <ListGroupItem className=\"border-0 px-0\">\r\n                    <h5 className=\"d-flex align-items-center gap-1\">\r\n                        ${price} <i class=\"ri-close-line\"></i> 1 pesrson\r\n                    </h5>\r\n                    <span>${price}</span>\r\n                </ListGroupItem>\r\n\r\n                <ListGroupItem className=\"border-0 px-0\">\r\n                    <h5>Service Charge</h5>\r\n                    <span>${serviceFee}</span>\r\n                </ListGroupItem>\r\n\r\n                <ListGroupItem className=\"border-0 px-0 total\">\r\n                    <h5>Total</h5>\r\n                    <span>${totalAmount}</span>\r\n                </ListGroupItem>\r\n            </ListGroup>\r\n\r\n            <Button className=\"btn primary__btn w-100 mt-4\" onClick={handleClick}>\r\n                Book Now\r\n            </Button>\r\n        </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Booking"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}